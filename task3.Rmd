### Task 3.

#### In this task, we use the Central Limit Theorem approximation for continuous random variables.

#### One of the devices to measure radioactivity level at a given location is the Geiger counter. When the radioactive level is almost constant, the time between two consecutive clicks of the Geiger counter is an exponentially distributed random variable with parameter $\nu_1 = \mathtt{team\,id\,number} + 10$. Denote by $X_k$ the random time between the $(k-1)^{\mathrm{st}}$ and $k^{\mathrm{th}}$ click of the counter.

1.  Show that the distribution of the sample means of $X_1, X_2,\dots,X_n$ gets very close to a normal one (which one?) as $n$ becomes large. To this end,
    -   simulate the realizations $x_1,x_2,\dots,x_n$ of the \textbf{r.v.} $X_i$ and calculate the sample mean $s=\overline{\mathbf{x}}$;\
    -   repeat this $K$ times to get the sample $\mathbf{s}=(s_1,\dots,s_K)$ of means and then the \emph{empirical cumulative distribution} function $F_{\mathbf{s}}$ of $\mathbf{s}$;\
    -   identify $\mu$ and $\sigma^2$ such that the \textbf{c.d.f.} of $\mathscr{N}(\mu,\sigma^2)$ is close to the \textbf{e.c.d.f.} $F_{\mathbf{s}}$ of and plot both \textbf{c.d.f.}'s on one graph to visualize their proximity;\
    -   calculate the maximal difference between the two \textbf{c.d.f.}'s;\
    -   consider cases $n = 5$, $n = 10$, $n=50$ and comment on the results.
2.  The place can be considered safe when the number of clicks in one minute does not exceed $100$. It is known that the parameter $\nu$ of the resulting exponential distribution is proportional to the number $N$ of the radioactive samples, i.e., $\nu = \nu_1*N$, where $\nu_1$ is the parameter for one sample. Determine the maximal number of radioactive samples that can be stored in that place so that, with probability $0.95$, the place is identified as safe. To do this,
    -   express the event of interest in terms of the \textbf{r.v.} $S:= X_1 + \cdots + X_{100}$;\
    -   obtain the theoretical bounds on $N$ using the Markov inequality, Chernoff bound and Central Limit Theorem and compare the results;\
    -   with the predicted $N$ and thus $\nu$, simulate the realization $x_1,x_2,\dots,x_{100}$ of the $X_i$ and of the sum $S = X_1 + \cdots + X_{100}$;\
    -   repeat this $K$ times to get the sample $\mathbf{s}=(s_1,\dots,s_K)$ of total times until the $100^{\mathrm{th}}$ click;\
    -   estimate the probability that the location is identified as safe and compare to the desired level $0.95$

## Part 1

### First, generate samples an sample means:

```{r}
set.seed(32)
team_number = 32
nu1 <- team_number + 10
K <- 1e3
n <- 5
sample_means <- colMeans(matrix(rexp(n*K, rate = nu1), nrow=n))
```

### Next, calculate the parameters of the standard normal approximation

```{r}
mu <- 1 / nu1
sigma <- 1 / (sqrt(n) * nu1)
```

### We can now plot ecdf and cdf

```{r}
xlims <- c(mu-3*sigma,mu+3*sigma)
Fs <- ecdf(sample_means)
plot(Fs, 
     xlim = xlims, 
     col = "blue",
     lwd = 2,
     main = "Comparison of ecdf and cdf")
curve(pnorm(x, mean = mu, sd = sigma), col = "red", lwd = 2, add = TRUE)
```

### Calculate the maximal difference between the two \textbf{c.d.f.}'s;  

```{r}
# Calculate the maximal difference between the two CDFs
x <- seq(0,.1,by=.0001)
Fs <- ecdf(sample_means)
max_difference = max(abs(Fs(x) - pnorm(x, mean = mu, sd = sigma)))

# Print the maximal difference
cat("Maximal Difference:", max_difference, "\n")

```

### Consider cases $n = 5$, $n = 10$, $n=50$

```{r}
calc_cases <- function(n) {
  sample_means <- colMeans(matrix(rexp(n*K, rate = nu1), nrow=n))
  sigma <- mu / sqrt(n)
  
  x <- seq(0,.1,by=.0001)
  Fs <- ecdf(sample_means)
  max_difference = max(abs(Fs(x) - pnorm(x, mean = mu, sd = sigma)))
  
  return (max_difference)
}

cat("n = 5: ", calc_cases(5), "\n")
cat("n = 10: ", calc_cases(10), "\n")
cat("n = 50: ", calc_cases(50), "\n")

```

## Part 2

### Express the event of interest in terms of the \textbf{r.v.} $S:= X_1 + \cdots + X_{100}$;

$$P(S \geq 60) \geq 0.95$$

### Obtain the theoretical bounds on $N$ using the Markov inequality, Chernoff bound and Central Limit Theorem and compare the results;

$$
E(S) = E(X_1 + \ldots + X_{100}) = E(X_1) + E(X_2) + \ldots =
100 \cdot E(X_i) = \frac{100}{\lambda \cdot N} = \frac{100}{42 \cdot N} \\
$$

1) $$ $$ $$ Markov\ ineqality$$

$$
0.95 \leq P(S \geq 1) \leq \frac{100}{42 \cdot N}\\0.95 \leq \frac{100}{42 \cdot N}\\N \leq 2.5
$$

2) $$ $$ $$ Chernoff\ bound$$

$$\mathbb{P}(X \geq a) \leq e^{-at}M_X(t)$$

$$\mathbb{P}(X \geq a) \leq e^{-at}\left(\frac{\lambda N}{\lambda N - t}\right)^{100}\;\;\;\;\;\;\;\; 0 \leq t \leq \lambda N$$

$$M_s(t) = E(e^{st}) = E(e^{(X_1 + X_2 + \ldots + X_{100})t}) = E(e^{x_1t} \cdot e^{x_2t} \cdot \ldots \cdot e^{x_{100}t}) = (E(e^{x_i t}))^{100} = (M_x(t))^{100} = \left(\frac{\lambda N}{\lambda N - t}\right)^{100}$$

$$0.95 \leq P(S \geq 1) \leq e^{-t} \left(\frac{\lambda N}{\lambda N - t}\right)^{100}$$

$$0.95 \leq e^{-t} \left(\frac{\lambda N}{\lambda N - t}\right)^{100}$$

$$We\ need\ to\ get\ N,\ so\ after\ some\ calculations,\ we\ get:$$

$$N \leq -\frac{t \cdot (0.95e^t)^{1/100}}{42 \cdot \left(1 - (0.95e^t)^{1/100}\right)}$$

$$
After\ minimizing\ we\ get:
$$

$$
N \leq 2.45
$$

3) $$ $$ $$ Central\ limit\ theorem$$$$ P\left(\frac{X_1 + \ldots + X_{100} - \mu}{\sigma\sqrt{n}} \leq\frac{1-n\mu}{\sigma\sqrt{n}}\right) \rightarrow \Phi\left(\frac{1-n\mu}{\sigma\sqrt{n}}\right)\\ so\ it \ is\  eqal\ to\\ \Phi\left(\frac{1-\frac{100}{42N}}{\frac{10}{42N}}\right)$$

### With the predicted $N$ and thus $\nu$, simulate the realization $x_1,x_2,\dots,x_{100}$ of the $X_i$ and of the sum $S = X_1 + \cdots + X_{100}$;

```{r}
sum(rexp(100, rate=2*42))

```

### Repeat this $K$ times to get the sample $\mathbf{s}=(s_1,\dots,s_K)$ of total times until the $100^{\mathrm{th}}$ click;

```{r}
# Let K = 100000
row_sum = rowSums(matrix(rexp(100*100000, rate = 2*42), nrow=100000))
```

### Estimate the probability that the location is identified as safe and compare to the desired level $0.95$

```{r}
row_sum_ecdf <- ecdf(row_sum)
safe <- 1 - row_sum_ecdf(1)
cat("Probability that the location is safe", safe)

```

### General summary and conclusions

In Task 3, the Central Limit Theorem is used to analyze the distribution of sample means of exponentially distributed random variables, which model the time between clicks of a Geiger counter measuring radioactivity. The goal is to determine the distribution of sample means, their proximity to a normal distribution, and to estimate the maximum number of radioactive samples that can be stored in a location while maintaining safety.

The results of these simulations and calculations provide insights into the behavior of the radioactive samples, the safety of the location, and how sample means approximate a normal distribution as \$n\$ increases.

The provided R code includes the actual implementation of these steps, and the output of each part can be observed through this code.
